"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.authPage = void 0;
var mongoose = require('mongoose');
const authPage = (Permissions) => {
    return async (req, res, next) => {
        const user = req.user;
        const userRole = 'admin';
        if (Permissions.includes(user === null || user === void 0 ? void 0 : user.role)) {
            next();
        }
        else {
            return res.status(401).send('access denied');
        }
    };
};
exports.authPage = authPage;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidmVyaWZ5VG9rZW4uanMiLCJzb3VyY2VSb290IjoiLi9zcmMvIiwic291cmNlcyI6WyJtaWRkbGV3YXJlcy92ZXJpZnlUb2tlbi50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7QUFJQSxJQUFJLFFBQVEsR0FBRyxPQUFPLENBQUMsVUFBVSxDQUFDLENBQUM7QUFzQm5DLE1BQU0sUUFBUSxHQUFHLENBQUMsV0FBVyxFQUFFLEVBQUU7SUFDL0IsT0FBTyxLQUFLLEVBQUUsR0FBRyxFQUFFLEdBQUcsRUFBRSxJQUFJLEVBQUUsRUFBRTtRQVUvQixNQUFNLElBQUksR0FBRyxHQUFHLENBQUMsSUFBYSxDQUFDO1FBQzlCLE1BQU0sUUFBUSxHQUFHLE9BQU8sQ0FBQztRQUN6QixJQUFJLFdBQVcsQ0FBQyxRQUFRLENBQUMsSUFBSSxhQUFKLElBQUksdUJBQUosSUFBSSxDQUFFLElBQUksQ0FBQyxFQUFFO1lBQ3BDLElBQUksRUFBRSxDQUFDO1NBQ1I7YUFBTTtZQUNMLE9BQU8sR0FBRyxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQyxJQUFJLENBQUMsZUFBZSxDQUFDLENBQUM7U0FDOUM7SUFDSCxDQUFDLENBQUM7QUFDSixDQUFDLENBQUM7QUFDTyw0QkFBUSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBKd3QgZnJvbSAnanNvbndlYnRva2VuJztcbmltcG9ydCB7IEV4dHJhY3RKd3QgfSBmcm9tICdwYXNzcG9ydC1qd3QnO1xuaW1wb3J0IGp3dERlY29kZSBmcm9tICdqd3QtZGVjb2RlJztcbmltcG9ydCB7IFVzZXIgLCBJVXNlcn0gZnJvbSAnLi4vbW9kZWxzL3VzZXIubW9kZWwnO1xudmFyIG1vbmdvb3NlID0gcmVxdWlyZSgnbW9uZ29vc2UnKTtcblxuXG5cblxuLy92ZXJpZnkgdG9rZW5cblxuLypjb25zdCBqd3QgPSBKd3Q7XG5mdW5jdGlvbiBhdXRoKHJlcSwgcmVzLCBuZXh0KSB7XG4gIGNvbnN0IHRva2VuID0gcmVxLmhlYWRlcignYXV0aC10b2tlbicpO1xuICBpZiAoIXRva2VuKSByZXR1cm4gcmVzLnN0YXR1cyg0MDEpLnNlbmQoJ0FjY2VzcyBkZW5pZWQnKTtcblxuICB0cnkge1xuICAgIGNvbnN0IHZlcmlmaWVkID0gand0LnZlcmlmeSh0b2tlbiwgSlNPTi5zdHJpbmdpZnkocHJvY2Vzcy5lbnYuVE9LRU5fU0VDUkVUKSk7XG4gICAgcmVxLnVzZXIgPSB2ZXJpZmllZDtcbiAgfSBjYXRjaCAoZXJyKSB7XG4gICAgcmVzLnN0YXR1cyg0MDApLnNlbmQoJ0ludmFsaWQgVG9rZW4nKTtcbiAgfVxuICBuZXh0KCk7XG59XG4qL1xuLy9cbmNvbnN0IGF1dGhQYWdlID0gKFBlcm1pc3Npb25zKSA9PiB7XG4gIHJldHVybiBhc3luYyAocmVxLCByZXMsIG5leHQpID0+IHtcbiAgICAvKmNvbnN0IHRva2VuID0gcmVxLmhlYWRlcignYWNjZXNzX3Rva2VuJyk7XG4gICAgY29uc3QgZGVjb2RlZCA9IGp3dERlY29kZSh0b2tlbik7XG4gICAgLy9jb25zb2xlLmxvZyhkZWNvZGVkLl9pZCk7XG4gICAgLy9jb25zb2xlLmxvZyh0eXBlb2YoZGVjb2RlZC5faWQpKVxuICAgIGNvbnN0IGlkID0gbW9uZ29vc2UuVHlwZXMuT2JqZWN0SWQoZGVjb2RlZC5faWQpXG4gICAgLy9jb25zb2xlLmxvZyhpZClcblxuICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBVc2VyLmZpbmRPbmUoeyBfaWQ6IGlkIH0pO1xuICAgLy8gY29uc29sZS5sb2codXNlcik7Ki9cbiAgIGNvbnN0IHVzZXIgPSByZXEudXNlciBhcyBJVXNlcjtcbiAgICBjb25zdCB1c2VyUm9sZSA9ICdhZG1pbic7XG4gICAgaWYgKFBlcm1pc3Npb25zLmluY2x1ZGVzKHVzZXI/LnJvbGUpKSB7XG4gICAgICBuZXh0KCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMSkuc2VuZCgnYWNjZXNzIGRlbmllZCcpO1xuICAgIH1cbiAgfTtcbn07XG5leHBvcnQgeyBhdXRoUGFnZSB9O1xuIl19