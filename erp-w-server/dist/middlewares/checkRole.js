"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.authPage = void 0;
var mongoose = require('mongoose');
const authPage = (Permissions) => {
    return async (req, res, next) => {
        const user = req.user;
        const userRole = 'admin';
        if (Permissions.includes(user === null || user === void 0 ? void 0 : user.role)) {
            next();
        }
        else {
            return res.status(401).send('access denied');
        }
    };
};
exports.authPage = authPage;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2hlY2tSb2xlLmpzIiwic291cmNlUm9vdCI6Ii4vc3JjLyIsInNvdXJjZXMiOlsibWlkZGxld2FyZXMvY2hlY2tSb2xlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7OztBQUlBLElBQUksUUFBUSxHQUFHLE9BQU8sQ0FBQyxVQUFVLENBQUMsQ0FBQztBQXNCbkMsTUFBTSxRQUFRLEdBQUcsQ0FBQyxXQUFXLEVBQUUsRUFBRTtJQUMvQixPQUFPLEtBQUssRUFBRSxHQUFHLEVBQUUsR0FBRyxFQUFFLElBQUksRUFBRSxFQUFFO1FBQy9CLE1BQU0sSUFBSSxHQUFHLEdBQUcsQ0FBQyxJQUFhLENBQUM7UUFDOUIsTUFBTSxRQUFRLEdBQUcsT0FBTyxDQUFDO1FBQ3pCLElBQUksV0FBVyxDQUFDLFFBQVEsQ0FBQyxJQUFJLGFBQUosSUFBSSx1QkFBSixJQUFJLENBQUUsSUFBSSxDQUFDLEVBQUU7WUFDcEMsSUFBSSxFQUFFLENBQUM7U0FDUjthQUFNO1lBQ0wsT0FBTyxHQUFHLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDLElBQUksQ0FBQyxlQUFlLENBQUMsQ0FBQztTQUM5QztJQUNILENBQUMsQ0FBQztBQUNKLENBQUMsQ0FBQztBQUNPLDRCQUFRIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IEp3dCBmcm9tICdqc29ud2VidG9rZW4nO1xuaW1wb3J0IHsgRXh0cmFjdEp3dCB9IGZyb20gJ3Bhc3Nwb3J0LWp3dCc7XG5pbXBvcnQgand0RGVjb2RlIGZyb20gJ2p3dC1kZWNvZGUnO1xuaW1wb3J0IHsgVXNlciAsIElVc2VyfSBmcm9tICcuLi9tb2RlbHMvdXNlci5tb2RlbCc7XG52YXIgbW9uZ29vc2UgPSByZXF1aXJlKCdtb25nb29zZScpO1xuXG5cblxuXG4vL3ZlcmlmeSB0b2tlblxuXG4vKmNvbnN0IGp3dCA9IEp3dDtcbmZ1bmN0aW9uIGF1dGgocmVxLCByZXMsIG5leHQpIHtcbiAgY29uc3QgdG9rZW4gPSByZXEuaGVhZGVyKCdhdXRoLXRva2VuJyk7XG4gIGlmICghdG9rZW4pIHJldHVybiByZXMuc3RhdHVzKDQwMSkuc2VuZCgnQWNjZXNzIGRlbmllZCcpO1xuXG4gIHRyeSB7XG4gICAgY29uc3QgdmVyaWZpZWQgPSBqd3QudmVyaWZ5KHRva2VuLCBKU09OLnN0cmluZ2lmeShwcm9jZXNzLmVudi5UT0tFTl9TRUNSRVQpKTtcbiAgICByZXEudXNlciA9IHZlcmlmaWVkO1xuICB9IGNhdGNoIChlcnIpIHtcbiAgICByZXMuc3RhdHVzKDQwMCkuc2VuZCgnSW52YWxpZCBUb2tlbicpO1xuICB9XG4gIG5leHQoKTtcbn1cbiovXG4vL1xuY29uc3QgYXV0aFBhZ2UgPSAoUGVybWlzc2lvbnMpID0+IHtcbiAgcmV0dXJuIGFzeW5jIChyZXEsIHJlcywgbmV4dCkgPT4ge1xuICAgY29uc3QgdXNlciA9IHJlcS51c2VyIGFzIElVc2VyO1xuICAgIGNvbnN0IHVzZXJSb2xlID0gJ2FkbWluJztcbiAgICBpZiAoUGVybWlzc2lvbnMuaW5jbHVkZXModXNlcj8ucm9sZSkpIHtcbiAgICAgIG5leHQoKTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAxKS5zZW5kKCdhY2Nlc3MgZGVuaWVkJyk7XG4gICAgfVxuICB9O1xufTtcbmV4cG9ydCB7IGF1dGhQYWdlIH07XG4iXX0=